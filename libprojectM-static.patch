--- projectM-2.0.1-Source/CMakeLists.txt~	2010-07-07 09:10:35.000000000 +0300
+++ projectM-2.0.1-Source/CMakeLists.txt	2010-07-07 09:13:39.657686690 +0300
@@ -29,7 +29,7 @@
 
 OPTION (USE_CG "Use Cg for Pixel Shader support" OFF)
 
-OPTION (BUILD_PROJECTM_STATIC "Build the projectM target library in the platform's native static (NOT shared) format." OFF)
+OPTION (BUILD_PROJECTM_STATIC "Build the projectM target library in the platform's native static format." OFF)
 
 OPTION (DISABLE_NATIVE_PRESETS "Turn off support for native (C++ style) presets" OFF)
 OPTION (DISABLE_MILKDROP_PRESETS "Turn off support for Milkdrop (.milk / .prjm) presets"  OFF)
@@ -48,12 +48,12 @@
 endif(USE_FBO)
 
 if (BUILD_PROJECTM_STATIC)
-ADD_LIBRARY(projectM STATIC ${projectM_SOURCES})
-else(BUILD_PROJECTM_STATIC)
-ADD_LIBRARY(projectM SHARED ${projectM_SOURCES})
+	ADD_LIBRARY(projectM-static STATIC ${projectM_SOURCES})
+	SET_TARGET_PROPERTIES(projectM-static PROPERTIES OUTPUT_NAME projectM)
 endif(BUILD_PROJECTM_STATIC)
+ADD_LIBRARY(projectM-shared SHARED ${projectM_SOURCES})
 
-SET_TARGET_PROPERTIES(projectM PROPERTIES VERSION 2.0.1 SOVERSION 2)
+SET_TARGET_PROPERTIES(projectM-shared PROPERTIES VERSION 2.0.1 SOVERSION 2 OUTPUT_NAME projectM)
 
 if (APPLE)
 ADD_DEFINITIONS(-DMACOS -DSTBI_NO_DDS -DUSE_THREADS)
@@ -177,13 +177,10 @@
 LINK_DIRECTORIES(${FTGL_LINK_DIRS} ${Renderer_BINARY_DIR} ${PRESET_FACTORY_BINARY_DIR})
 
 if(BUILD_PROJECTM_STATIC)
-		TARGET_LINK_LIBRARIES(projectM ${GLEW_LINK_TARGETS} m ${FTGL_LINK_TARGETS} ${OPENGL_LIBRARIES} ${IMAGE_LINK_TARGETS} ${CG_LINK_TARGETS} ${PRESET_FACTORY_LINK_TARGETS})
-else(BUILD_PROJECTM_STATIC)
-
-TARGET_LINK_LIBRARIES(projectM ${GLEW_LINK_TARGETS} m ${FTGL_LINK_TARGETS} ${OPENGL_LIBRARIES}  ${IMAGE_LINK_TARGETS} ${CG_LINK_TARGETS} ${PRESET_FACTORY_LINK_TARGETS})
-
+	TARGET_LINK_LIBRARIES(projectM-static ${GLEW_LINK_TARGETS} m ${FTGL_LINK_TARGETS} ${OPENGL_LIBRARIES} ${IMAGE_LINK_TARGETS} ${CG_LINK_TARGETS} ${PRESET_FACTORY_LINK_TARGETS})
 endif(BUILD_PROJECTM_STATIC)
 
+TARGET_LINK_LIBRARIES(projectM-shared ${GLEW_LINK_TARGETS} m ${FTGL_LINK_TARGETS} ${OPENGL_LIBRARIES}  ${IMAGE_LINK_TARGETS} ${CG_LINK_TARGETS} ${PRESET_FACTORY_LINK_TARGETS})
 
 CONFIGURE_FILE("${CMAKE_CURRENT_SOURCE_DIR}/libprojectM.pc.in" "${CMAKE_CURRENT_SOURCE_DIR}/libprojectM.pc" @ONLY)
 CONFIGURE_FILE("${CMAKE_CURRENT_SOURCE_DIR}/config.inp.in" "${CMAKE_CURRENT_SOURCE_DIR}/config.inp" @ONLY)
@@ -196,4 +193,7 @@
 INSTALL(FILES ${CMAKE_CURRENT_SOURCE_DIR}/libprojectM.pc DESTINATION ${CMAKE_INSTALL_PREFIX}/lib${LIB_SUFFIX}/pkgconfig)
 INSTALL(FILES ${CMAKE_CURRENT_SOURCE_DIR}/config.inp DESTINATION ${CMAKE_INSTALL_PREFIX}/share/projectM)
 INSTALL(FILES projectM.hpp event.h dlldefs.h fatal.h PCM.hpp Common.hpp DESTINATION include/libprojectM)
-INSTALL(TARGETS projectM DESTINATION lib${LIB_SUFFIX})
+if (BUILD_PROJECTM_STATIC)
+	INSTALL(TARGETS projectM-static DESTINATION lib${LIB_SUFFIX})
+endif(BUILD_PROJECTM_STATIC)
+INSTALL(TARGETS projectM-shared DESTINATION lib${LIB_SUFFIX})
